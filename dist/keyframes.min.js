"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(t,a,s,u){return new(s=s||Promise)(function(e,n){function i(t){try{o(u.next(t))}catch(t){n(t)}}function r(t){try{o(u.throw(t))}catch(t){n(t)}}function o(t){t.done?e(t.value):function(e){return e instanceof s?e:new s(function(t){t(e)})}(t.value).then(i,r)}o((u=u.apply(t,a||[])).next())})},__generator=this&&this.__generator||function(n,i){var r,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=i.call(n,s)}catch(t){e=[6,t],o=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var keyframesSheet,add_px_to_style_1=__importDefault(require("add-px-to-style")),hyphenate_style_name_1=__importDefault(require("hyphenate-style-name")),wait=function(){return new Promise(function(t){requestAnimationFrame(function(){t()})})},isBrowser="undefined"!=typeof window;if(isBrowser){var styleElem=document.createElement("style");styleElem.setAttribute("id","keyframesjs-stylesheet"),document.head.appendChild(styleElem),keyframesSheet=styleElem.sheet}var voidFunction=function(){},objToCss=function(t){if(!Object.keys(t).length)return"";var e="";for(var n in t)e+=hyphenate_style_name_1.default(n)+":"+add_px_to_style_1.default(n,t[n])+";";return e},Keyframes=function(){function d(t){this.queueStore=[],this.callbacks={onStart:voidFunction,onBeforeStart:voidFunction,onIteration:voidFunction,onEnd:voidFunction},this.animationendListener=voidFunction,this.animationiterationListener=voidFunction,this.mountedElement=t}return d.isSupported=function(){return void 0!==document.body.style.animationName},d.prototype.reset=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.removeEvents(),this.mountedElement.style.animationPlayState="running",this.mountedElement.style.animation="none",[4,wait()];case 1:return t.sent(),[2,this]}})})},d.prototype.pause=function(){return this.mountedElement.style.animationPlayState="paused",this},d.prototype.resume=function(){return this.mountedElement.style.animationPlayState="running",this},d.prototype.play=function(e,n){var i=this;if(this.mountedElement.style.animationName===this.getAnimationName(e))return requestAnimationFrame(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.reset()];case 1:return t.sent(),this.play(e,n),[2]}})})}),this;function t(t,e){var n=t+"Listener";i.mountedElement.removeEventListener(t,i[n]),i[n]=e,i.mountedElement.addEventListener(t,i[n])}var r=n||{},o=r.onBeforeStart,a=void 0===o?null:o,s=r.onStart,u=void 0===s?null:s,l=r.onIteration,c=void 0===l?null:l,h=r.onEnd,f=void 0===h?null:h,m=d.playCSS(e);return a&&a(),this.mountedElement.style.animationPlayState="running",this.mountedElement.style.animation=m,c&&t("animationiteration",c),f&&t("animationend",f),u&&requestAnimationFrame(u),this},d.prototype.removeEvents=function(){return this.mountedElement.removeEventListener("animationiteration",this.animationiterationListener),this.mountedElement.removeEventListener("animationend",this.animationendListener),this},d.prototype.playNext=function(){var t=this,e=this.queueStore.pop();e?this.play(e,{onEnd:function(){return t.playNext()},onIteration:this.callbacks.onIteration}):this.callbacks.onEnd&&this.callbacks.onEnd()},d.prototype.updateCallbacks=function(t){t&&(this.callbacks=__assign(__assign({},this.callbacks),t))},d.prototype.queue=function(t,e){var n=this.queueStore.length;return this.updateCallbacks(e),t.constructor===Array?this.queueStore=t.reverse().concat(this.queueStore):this.queueStore.unshift(t),n||(this.callbacks.onBeforeStart&&this.callbacks.onBeforeStart(),this.playNext(),this.callbacks.onStart&&requestAnimationFrame(this.callbacks.onStart)),this},d.prototype.resetQueue=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,wait()];case 1:return t.sent(),this.removeEvents(),this.queueStore=[],[4,this.reset()];case 2:return t.sent(),[2,this]}})})},d.prototype.chain=function(e,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.resetQueue()];case 1:return t.sent(),this.queue(e,n),[2,this]}})})},d.prototype.getAnimationName=function(t){switch(t.constructor){case Array:return t.map(this.getAnimationName).join(", ");case String:return t.split(" ")[0];default:return t.name}},d.playCSS=function(t){function e(t){var e=__assign({duration:"0s",timingFunction:"ease",delay:"0s",iterationCount:1,direction:"normal",fillMode:"forwards"},t);return[e.name,e.duration,e.timingFunction,e.delay,e.iterationCount,e.direction,e.fillMode].join(" ")}if(t.constructor!==Array)return t.constructor===String?t:e(t);for(var n=t,i=[],r=0;r<n.length;r+=1)i.push(n[r].constructor===String?n[r]:e(n[r]));return i.join(", ")},d.generateCSS=function(t){var e="@keyframes "+t.name+" {";for(var n in t){if("name"!==n&&"media"!==n&&"complete"!==n)e+=n+" {"+objToCss(t[n])+"}"}return e+="}",t.media&&(e="@media "+t.media+"{"+e+"}"),e},d.generate=function(t){var e=this.generateCSS(t),n=d.rules.indexOf(t.name);-1<n&&(d.sheet.deleteRule(n),d.rules.splice(n,1));var i=(d.sheet.cssRules||d.sheet.rules).length;d.sheet.insertRule(e,i),d.rules[i]=t.name},d.define=function(t){if(t.length)for(var e=0;e<t.length;e+=1)this.generate(t[e]);else this.generate(t)},d.defineCSS=function(t){if(t.length){for(var e="",n=0;n<t.length;n+=1)e+=this.generateCSS(t[n]);return e}return this.generateCSS(t)},d.plugin=function(t){if(t.constructor===Array)for(var e=0;e<t.length;e+=1)t[e](this);else t(this)},d.sheet=keyframesSheet,d.rules=[],d}();isBrowser&&(window.Keyframes=Keyframes),exports.default=Keyframes;
